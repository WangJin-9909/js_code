!function(){"use strict";function t(t,e){for(var s in this.opts={mode:"fixed",imageUrl:"bgimg/demo.jpeg",sliceImageUrl:"bgimg/demo.jpeg",imageType:"stream",bgWidth:300,bgHeight:200,barHeight:24,dragWidth:34,dragHeight:24,dragBorderR:12,dragColor:"#1296db",bgMarginW:18,barBgDistance:2,bgColor:"#e4e4e4",message:{loading:"加载中...",checking:"正在验证 请稍等...",tip:"按住滑块，拖动完成拼图",seccess:"验证成功",fail:"位置不正确",forbidden:"操作异常",error:"网络错误"},clientID:null,useCanvas:!0,cw:60,ch:60,cRadius:8,cTransparency:.8,useMixBlock:!0,allowSameRow:!1,cMixTransparency:.6,dragClip:!0,posx:0,posy:0,blockStyle:[-1,0,0,1],padding:0,needAgainNum:2,useDES3:!0,useDeviceInfo:!0,interval:5,requestData:null,sendData:null,ready:function(){},checkResult:function(t){},eventinfo:{flag:!1,currentX:0}},this.captchaBoxId=t,this.captchaDOM={captchaBox:null},this.deviceType="Windows",this.imageObject=null,this.userIsCan=!0,this.errorNum=0,this.keys="",this.startTime=(new Date).getTime(),this.requestDataDone=!1,this.intervalDone=!0,window.console||(window.console={log:function(){},warn:function(){},error:function(){},info:function(){}}),e)this.opts.hasOwnProperty(s)&&(this.opts[s]=e[s]);this.initData()}var e={curBrowser:"unknown",browserVer:0,debug_log:function(t){window.console&&console.log(t)},debug_error:function(t){window.console&&console.error(t)},debug_warn:function(t){window.console&&console.warn(t)},checkBrowser:function(){var t=navigator.userAgent.toLowerCase();if(-1<t.indexOf("msie")){this.curBrowser="ie";var e=t.match(/msie ([\d.]+)/)[1];this.browserVer=e}else this.curBrowser="other"}};t.prototype={getVersion:function(){return"1.0.0"},destroy:function(){for(var t in this.captchaDOM.captchaBox.innerHTML="",this)"function"==typeof this[t]?this[t]=function(){}:"object"==typeof this[t]&&(this[t]={})},initData:function(){if("string"==typeof this.captchaBoxId)if(this.captchaDOM.captchaBox=document.getElementById(this.captchaBoxId),this.captchaDOM.captchaBox)if(this.opts.requestData)if(this.opts.sendData){if(!this.opts.clientID)return console.error("clientID 不能为空。"),"";if("string"==typeof this.opts.bgWidth)if(-1!=this.opts.bgWidth.indexOf("%")){if(!this.isMobileDevice())return void console.error("非移动端 宽度不可以使用百分比的方式！");var t=window.screen.width;t/=window.devicePixelRatio,this.opts.bgWidth=parseInt(this.opts.bgWidth)/100*t}else this.opts.bgWidth=parseInt(this.opts.bgWidth);if("string"==typeof this.opts.bgHeight&&(-1!=this.opts.bgHeight.indexOf("%")?this.opts.bgHeight=parseInt(this.opts.bgHeight)/100*this.opts.bgWidth:this.opts.bgHeight=parseInt(this.opts.bgHeight)),this.getDeviceType(),this.checkBrowser(),this.createCaptchaBox(this.captchaDOM.captchaBox),this.showLoading(!0),this.setUserEvent(),this.initMouseTrack(),this.refreshMethod(),"pop"===this.opts.mode&&!this.isMobileDevice()){var e=this;this.captchaDOM.captchaBox.onmouseover=function(t){e.showImg()},this.captchaDOM.captchaBox.onmouseout=function(t){e.hideImg()}}"pop"!==this.opts.mode||this.isMobileDevice()?this.captchaDOM.slicebody.style.position="relative":(this.captchaDOM.slicebody.style.display="none",this.captchaDOM.slicebody.style.position="absolute",this.captchaDOM.slicebody.style.bottom=this.opts.barHeight+this.opts.barBgDistance+"px")}else console.error("sendData is must");else console.error("requestData is must");else console.error("captchaBoxId is error");else console.error("captchaBoxId is must be string")},initMouseTrack:function(){try{mouseTrack?mouseTrack.initMouseTrack(this.captchaBoxId):console.error("mouseTrack 未定义")}catch(t){console.error("mouseTrack.initMouseTrack 执行时出现了错误，详细信息如下："),console.log(t)}},clearMouseTrack:function(){try{mouseTrack?mouseTrack.clearTrackInfo():console.error("mouseTrack 未定义")}catch(t){console.error("mouseTrack.clearTrackInfo 执行时出现了错误，详细信息如下："),console.log(t)}},getMouseTrack:function(){try{if(mouseTrack)return mouseTrack.mouseTrackInfo();console.error("mouseTrack 未定义")}catch(t){console.error("mouseTrack.mouseTrackInfo 执行时出现了错误，详细信息如下："),console.log(t)}},extend:function(t,e){if(null==e)return t;for(var s in e)null!=e[s]&&t[s]!==e[s]&&(t[s]=e[s]);return t},getDeviceInfo:function(){var t={},e={};try{navigatorFinger?t=navigatorFinger.get():console.error("navigatorFinger 未定义")}catch(t){console.error("navigatorFinger.get 执行时出现了错误，详细信息如下："),console.log(t)}try{windowFinger?e=windowFinger.get():console.error("windowFinger 未定义")}catch(t){console.error("windowFinger.get 执行时出现了错误，详细信息如下："),console.log(t)}return this.extend(e,t),e},createKey:function(t,e){var s=t;e&&(s+=e);try{return s=(s=sha256_digest(s)).substr(4,s.length-8)}catch(t){return console.error("生成秘钥时出现异常，详细信息如下："),console.log(t),""}},DES3encrypt:function(t,e){var s="";try{s=DES3.encrypt(t,e)}catch(t){return console.error("加密时出现异常，详细信息如下："),console.log(t),""}return s},DES3decrypt:function(t,e){var s="";try{s=DES3.decrypt(t,e)}catch(t){console.error("解密时出现异常，详细信息如下："),console.log(t)}return s},setBlockStyle:function(t){"object"!=typeof t||4!=t.length&&0!=t.length?(this.opts.blockStyle=[-1,1,0,-1],console.error("函数 setBlockStyle 的参数必须是一个长度为4的数字数组或空数组，例如[-1, 1, 0, -1]或[]")):this.opts.blockStyle=t,this.imageObject&&(this.opts.useCanvas?this.drawCaptcha(this.imageObject):this.drawCaptcha_NoCanvas(this.imageObject))},getDeviceType:function(){var t=navigator.platform;0<=t.indexOf("Win")?this.deviceType="Windows":0<=t.indexOf("Linux")?this.deviceType="Android":0<=t.indexOf("iPhone")?this.deviceType="iPhone":this.deviceType="Unknown"},isMobileDevice:function(){var t=navigator.platform;return 0<=t.indexOf("Linux")||0<=t.indexOf("iPhone")},checkBrowser:function(){var t=navigator.userAgent.toLowerCase();-1<t.indexOf("msie")&&t.match(/msie ([\d.]+)/)[1]<=8&&(this.opts.useCanvas=!1)},createCaptchaBox:function(t){if('<div id="slice-body" class="slice-border-radius" style="background-color: rgb(229, 229, 229); position: relative;">','  <div id="slice-loading" style="width: 100%; height: 100%; display: none;">','    <div style="height: 50%;"></div><div id="slice-loadingMsg" class="slice-noselect" style="text-align: center;"></div>',"  </div>",'  <div id="slice-canvas-panel" style="width: 100%; height: 100%; display: block; position: relative;">','    <div id="slice-refresh" style="z-index: 3; display: block;"></div>','    <div id="slice-canvasbox" style="width: 100%; height: 100%;">','      <canvas id="slice-canvas" width="100%" height="100%"></canvas>',"    </div>",'    <div id="slice-clipblock" style="left: 10px; top: 57px; position: absolute;">','      <canvas id="slice-clipcanvas" class="drag-slider" width="50" height="50"></canvas>',"    </div>","  </div>",'  <div id="slice-result" class="slice-result slice-noselect" style="text-align: center;"></div>',"</div>",'<div id="slice-dragbar" style="position: relative;">','  <div id="slice-drag-track" class="slice-border-radius slice-noselect" style="width: 100%; height: 13px; position: relative; text-align: center; line-height: 24px; font-size: 12px; border-radius: 7px; border: 1px solid #ddd;"></div>','  <div id="slice-drag-slider" class="slice-border-radius" style="left: 18px;top:1px">','    <div id="slice-drag-slider-img" style="position:relative; left:9px; top:6px; width:12px; height:12px; background-image: url(&quot;./icon/slider.png&quot;);background-size: 100%"></div>',"  </div>","</div>",t.innerHTML='<div id="slice-body" class="slice-border-radius" style="background-color: rgb(229, 229, 229); position: relative;">  <div id="slice-loading" style="width: 100%; height: 100%; display: none;">    <div style="height: 50%;"></div><div id="slice-loadingMsg" class="slice-noselect" style="text-align: center;"></div>  </div>  <div id="slice-canvas-panel" style="width: 100%; height: 100%; display: block; position: relative;">    <div id="slice-refresh" style="z-index: 3; display: block;"></div>    <div id="slice-canvasbox" style="width: 100%; height: 100%;">      <canvas id="slice-canvas" width="100%" height="100%"></canvas>    </div>    <div id="slice-clipblock" style="left: 10px; top: 57px; position: absolute;">      <canvas id="slice-clipcanvas" class="drag-slider" width="50" height="50"></canvas>    </div>  </div>  <div id="slice-result" class="slice-result slice-noselect" style="text-align: center;"></div></div><div id="slice-dragbar" style="position: relative;">  <div id="slice-drag-track" class="slice-border-radius slice-noselect" style="width: 100%; height: 13px; position: relative; text-align: center; line-height: 24px; font-size: 12px; border-radius: 7px; border: 1px solid #ddd;"></div>  <div id="slice-drag-slider" class="slice-border-radius" style="left: 18px;top:1px">    <div id="slice-drag-slider-img" style="position:relative; left:9px; top:6px; width:12px; height:12px; background-image: url(&quot;./icon/slider.png&quot;);background-size: 100%"></div>  </div></div>',t.align="left",t.style.position="relative",!this.opts.useCanvas){var e='<img id="slice-canvas" width="0" height="0" src="" style="display:none"></img>';document.getElementById("slice-canvasbox").innerHTML=e;e='<img id="slice-clipcanvas" class="drag-slider" width="0" height="0" src=""></img>';document.getElementById("slice-clipblock").innerHTML=e}this.captchaDOM.slicebody=document.getElementById("slice-body"),this.captchaDOM.loading=document.getElementById("slice-loading"),this.captchaDOM.loadMsg=document.getElementById("slice-loadingMsg"),this.captchaDOM.canvasPanel=document.getElementById("slice-canvas-panel"),this.captchaDOM.track=document.getElementById("slice-drag-track"),this.captchaDOM.slider=document.getElementById("slice-drag-slider"),this.captchaDOM.sliderImg=document.getElementById("slice-drag-slider-img"),this.captchaDOM.clipblock=document.getElementById("slice-clipblock"),this.captchaDOM.result=document.getElementById("slice-result"),this.captchaDOM.refresh=document.getElementById("slice-refresh"),this.captchaDOM.dragbar=document.getElementById("slice-dragbar"),this.captchaDOM.canvas=document.getElementById("slice-canvas"),this.captchaDOM.clipcanvas=document.getElementById("slice-clipcanvas"),this.captchaDOM.resultClass=this.captchaDOM.result.className,t.style.padding="0px",t.style.width=this.opts.bgWidth+2*this.opts.bgMarginW+"px",this.captchaDOM.canvas.width=this.opts.bgWidth,this.captchaDOM.canvas.height=this.opts.bgHeight,this.captchaDOM.clipcanvas.width=this.opts.cw,this.captchaDOM.clipcanvas.height=this.opts.ch,this.captchaDOM.slicebody.style.width=this.opts.bgWidth+"px",this.captchaDOM.slicebody.style.height=this.opts.bgHeight+"px",this.captchaDOM.slicebody.style.padding=this.opts.bgMarginW+"px",this.captchaDOM.slicebody.style.borderRadius=this.opts.bgMarginW+"px",this.captchaDOM.slicebody.style.backgroundColor=this.opts.bgColor,this.captchaDOM.clipblock.style.width=this.opts.cw+"px",this.captchaDOM.clipblock.style.height=this.opts.ch+"px",this.captchaDOM.dragbar.style.width=this.opts.bgWidth+"px",this.captchaDOM.dragbar.style.height=this.opts.barHeight+"px",this.captchaDOM.dragbar.style.left=this.opts.bgMarginW+"px",this.captchaDOM.dragbar.style.paddingTop=this.opts.barBgDistance+"px",this.captchaDOM.track.style.height=this.opts.barHeight+"px",this.captchaDOM.track.style.lineHeight=this.opts.barHeight+"px",this.captchaDOM.track.style.backgroundColor=this.opts.bgColor,this.captchaDOM.slider.style.width=this.opts.dragWidth+"px",this.captchaDOM.slider.style.height=this.opts.dragHeight+"px",this.captchaDOM.slider.style.borderRadius=this.opts.dragBorderR+"px",this.captchaDOM.slider.style.top=this.opts.barBgDistance+1+this.opts.barHeight/2-this.opts.dragHeight/2+"px",this.captchaDOM.slider.style.backgroundColor=this.opts.dragColor,this.captchaDOM.sliderImg.style.left=(this.opts.dragWidth-12)/2+"px",this.captchaDOM.sliderImg.style.top=(this.opts.dragHeight-12)/2+"px",this.captchaDOM.result.style.width=this.opts.bgWidth+"px",this.captchaDOM.result.style.left=this.opts.bgMarginW+"px",this.captchaDOM.canvas.onmousedown=this.captchaDOM.canvas.onmousemove=function(t){(t=t||window.event).preventDefault?t.preventDefault():t.returnValue=!1},this.setEleCannotselect(this.captchaDOM.track),this.setEleCannotselect(this.captchaDOM.loadMsg)},showLoading:function(t){var e=this.captchaDOM.loading,s=this.captchaDOM.canvasPanel;t?(e.style.display="block",s.style.display="none"):(e.style.display="none",s.style.display="block")},setMessage:function(t){this.captchaDOM.track.innerHTML=t},setFloatMessage:function(t){this.captchaDOM.result.innerHTML=t},setLoadMessage:function(t){this.captchaDOM.loadMsg.innerHTML=t},setUserEvent:function(){var e=this;function t(t){e.moveStart(t)}function s(t){e.move(t)}function i(t){setTimeout(function(){e.moveEnd(t)},100)}this.captchaDOM.slider.addEventListener?(this.opts.dragClip&&this.captchaDOM.clipblock.addEventListener("touchstart",t),this.captchaDOM.slider.addEventListener("touchstart",t),this.captchaDOM.captchaBox.addEventListener("touchmove",s),this.captchaDOM.captchaBox.addEventListener("touchend",i)):this.captchaDOM.slider.attachEvent&&(this.opts.dragClip&&this.captchaDOM.clipblock.attachEvent("ontouchstart",t),this.captchaDOM.slider.attachEvent("ontouchstart",t),this.captchaDOM.captchaBox.attachEvent("ontouchmove",s),this.captchaDOM.captchaBox.attachEvent("ontouchend",i)),this.opts.dragClip?(this.captchaDOM.clipblock.onmousedown=t,this.captchaDOM.clipcanvas.onmousemove=function(t){(t=t||window.event).preventDefault?t.preventDefault():t.returnValue=!1}):this.captchaDOM.clipblock.onmousedown=this.captchaDOM.clipblock.onmousemove=function(t){(t=t||window.event).preventDefault?t.preventDefault():t.returnValue=!1},this.captchaDOM.slider.onmousedown=t,window.document.onmousemove=s,window.document.onmouseup=i,this.captchaDOM.refresh.onmousedown=function(t){e.refreshMethod(t)}},setUserCanOperation:function(t){this.captchaDOM.refresh.style.display=t?"block":"none",this.userIsCan=t},loadBGImage:function(t){try{var e=new Image;e.src=t;var s=this;this.imageObject=e,s.opts.useCanvas?e.complete?s.drawCaptcha(e):$(e).load(function(t){s.drawCaptcha(this)}):s.drawCaptcha_NoCanvas(e)}catch(t){console.error("加载图片出错，错误信息如下："),console.log(t)}},refreshMethod:function(){try{if(!this.opts.requestData)return void console.error("必须定义 requestData() 函数，以便向服务器请求数据。");var e=this;this.errorNum=0,this.showLoading(!0),this.setUserCanOperation(!1),this.setLoadMessage(this.opts.message.loading),this.setMessage(this.opts.message.loading);var t={captchaType:0,width:this.opts.bgWidth,height:this.opts.bgHeight,cw:this.opts.cw,ch:this.opts.ch};this.requestDataDone=!1,this.opts.requestData(t,function(t){e.analysisParam(t),e.loadBGImage(e.opts.imageUrl),e.reset(),e.requestDataDone=!0,e.intervalDone&&e.setUserCanOperation(!0);try{e.opts.ready()}catch(t){console.error("执行 ready() 函数时出错，错误信息如下："),console.log(t)}},function(t){e.setLoadMessage(this.opts.message.error),e.setMessage(this.opts.message.error)},this)}catch(t){console.error("执行 requestData() 函数时出错，错误信息如下："),console.log(t)}},analysisParam:function(t){try{var e=JSON.parse(t);this.opts.useDES3&&(e.data=this.DES3decrypt(this.createKey(this.opts.clientID),e.data)),e.data=JSON.parse(e.data)}catch(t){return void console.error("JSON解析服务器参数出错。")}this.keys=e.data.keys,this.opts.imageUrl=e.imageUrl,this.opts.sliceImageUrl=e.sliceImageUrl,this.opts.imageUrl?this.opts.sliceImageUrl||this.opts.useCanvas?this.opts.useCanvas&&(e.data.pointX<this.opts.cw/2||e.data.pointX>this.opts.bgWidth-this.opts.cw/2||e.data.pointY<this.opts.ch/2||e.data.pointY>this.opts.bgHeight-this.opts.ch/2)?console.error("抠图中心点("+e.data.pointX+","+e.data.pointY+")不可以靠近边界"):(this.opts.posx=e.data.pointX,this.opts.posy=e.data.pointY):console.error("不使用Canvas时, sliceImageUrl 不能为空"):console.error("imageUrl 不能为空")},showImg:function(){this.captchaDOM.slicebody.style.display="block"},hideImg:function(){this.captchaDOM.slicebody.style.display="none"},isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},createCanvas:function(t,e){var s=document.createElement("canvas");return s.width=t,s.height=e,s},clipPath:function(t,e,s,i){if(t&&"object"==typeof i&&(4==i.length||0==i.length)){var a=Math.min(this.opts.cw,this.opts.ch),o=this.opts.cRadius;o<4&&(o=4),(a/2-5)/2<o&&(o=(a/2-5)/2);var c=this.opts.cw-2*o,r=this.opts.ch-2*o;e+=o,s+=o;for(var n=[],h=0;h<i.length;h++){var l=i[h];n.push({isArc:-1==l||1==l,isTu:1==l})}t.beginPath(),t.moveTo(e,s),n[0].isArc&&(t.lineTo(e+parseInt(c/2)-o,s),n[0].isTu?t.arc(e+parseInt(c/2),s,o,-Math.PI,0,!1):t.arc(e+parseInt(c/2),s,o,-Math.PI,0,!0)),t.lineTo(e+c,s),n[1].isArc&&(t.lineTo(e+c,s+parseInt(r/2)-o),n[1].isTu?t.arc(e+c,s+parseInt(r/2),o,-Math.PI/2,Math.PI/2,!1):t.arc(e+c,s+parseInt(r/2),o,-Math.PI/2,Math.PI/2,!0)),t.lineTo(e+c,s+r),n[2].isArc&&(t.lineTo(e+(parseInt(c/2)+o),s+r),n[2].isTu?t.arc(e+parseInt(c/2),s+r,o,0,Math.PI,!1):t.arc(e+parseInt(c/2),s+r,o,0,Math.PI,!0)),t.lineTo(e,s+r),n[3].isArc&&(t.lineTo(e,s+parseInt(r/2)+o),n[3].isTu?t.arc(e,s+parseInt(r/2),o,Math.PI/2,-Math.PI/2,!1):t.arc(e,s+parseInt(r/2),o,Math.PI/2,-Math.PI/2,!0)),t.lineTo(e,s),t.closePath()}},fillClip:function(t,e,s,i,a){var o=t.getContext("2d");this.clipPath(o,e,s,i),o.fillStyle="rgba(99,99,99, "+a+")",o.fill()},strokeClip:function(t,e,s,i){var a=t.getContext("2d");this.clipPath(a,e,s,i),a.strokeStyle="#fff",a.stroke()},randomNum:function(t,e){var s=e-t;return t+Math.round(Math.random()*s)},getStartPoint:function(t,e){var s=this.opts.padding+this.opts.cw/2,i=this.opts.padding+this.opts.ch/2;return t<2*s||e<2*i?{centerX:t/2,centerY:e/2}:{centerX:randomNum(s,t-s),centerY:randomNum(i,e-i)}},getStartPoint_MIX:function(t,e,s,i){var a=this.opts.padding+this.opts.cw/2,o=this.opts.padding+this.opts.ch/2;if(t<2*a||e<2*o)return{centerX:t/2,centerY:e/2};for(;;){0;var c={centerX:this.randomNum(a,t-a),centerY:this.randomNum(o,e-o)};if(!(c.centerX<s+this.opts.cw&&c.centerX>s-this.opts.cw&&c.centerY<i+this.opts.ch&&c.centerY>i-this.opts.ch))break}return c},checkStartPoint:function(t,e,s,i){var a=opts.cw/2+opts.padding,o=opts.ch/2+opts.padding;return!(t<a||s-a<t)&&!(e<opts.padding||i-o<e)},createSlice_Canvas:function(t,e,s,i,a,o){var c=this.createCanvas(e,s).getContext("2d");c.drawImage(t,0,0,e,s),c.globalCompositeOperation="destination-in";var r=this.createCanvas(this.opts.cw,this.opts.ch);this.fillClip(r,0,0,o,1),c.drawImage(r,i,a);var n=this.captchaDOM.clipcanvas,h=c.getImageData(i,a,this.opts.cw,this.opts.ch);return n.getContext("2d").putImageData(h,0,0),this.strokeClip(n,0,0,o),n},updateSlice:function(t,e,s,i){var a=this.captchaDOM.clipblock;this.opts.useCanvas?this.createSlice_Canvas(t,this.opts.bgWidth,this.opts.bgHeight,e,s,i):(this.captchaDOM.clipcanvas.className="slice-background-size",this.captchaDOM.clipcanvas.src=this.opts.sliceImageUrl),a.style.top=s+"px",a.style.left=this.opts.padding+"px"},drawCaptcha:function(t){if(0!=this.opts.posx&&0!=this.opts.posy){var e={startx:this.opts.posx-this.opts.cw/2,starty:this.opts.posy-this.opts.ch/2};0,this.showLoading(!1),this.setMessage(this.opts.message.tip);var s=this.captchaDOM.canvas;s.getContext("2d").drawImage(t,0,0,this.opts.bgWidth,this.opts.bgHeight);var i=this.opts.blockStyle;if(0==i.length)i=[Math.round(3*Math.random())-1,Math.round(3*Math.random())-1,Math.round(3*Math.random())-1,Math.round(3*Math.random())-1];if(this.fillClip(s,e.startx,e.starty,i,this.opts.cTransparency),this.opts.useMixBlock){var a=this.getStartPoint_MIX(this.opts.bgWidth,this.opts.bgHeight,e.startx,e.starty);this.fillClip(s,a.centerX,a.centerY,i,this.opts.cMixTransparency)}this.updateSlice(t,e.startx,e.starty,i)}},drawCaptcha_NoCanvas:function(t){var e={startx:this.opts.posx-this.opts.cw/2,starty:this.opts.posy-this.opts.ch/2};this.captchaDOM.canvas.src=this.opts.imageUrl,this.captchaDOM.canvas.className="slice-background-size";var s=this;this.captchaDOM.canvas.style.display="none",this.captchaDOM.clipcanvas.style.display="none",this.captchaDOM.canvas.onload=function(){s.captchaDOM.canvas.style.display="block",s.captchaDOM.clipcanvas.style.display="block",s.showLoading(!1),s.setMessage(s.opts.message.tip)},this.updateSlice(t,e.startx,e.starty)},captchaShake:function(){var t=this.captchaDOM.result.className;this.captchaDOM.result.className+=" shake";var e=this;setTimeout(function(){e.captchaDOM.result.className=t},500)},setResultStatus:function(s,t){"success"==s?(this.setMessage(t+","+this.opts.message.seccess),this.setFloatMessage(this.opts.message.seccess),this.captchaDOM.result.className=this.captchaDOM.resultClass+" success",this.captchaDOM.track.style.color="#4cae4c",this.captchaDOM.track.style.borderColor="#4cae4c"):"fail"==s?(this.setMessage(this.opts.message.fail),this.captchaDOM.result.className=this.captchaDOM.resultClass+" fail",this.captchaDOM.track.style.color="#d9534f",this.captchaDOM.track.style.borderColor="#d9534f"):(this.setMessage(this.opts.message.forbidden),this.captchaDOM.result.className=this.captchaDOM.resultClass+" fail",this.captchaDOM.track.style.color="#d953ff",this.captchaDOM.track.style.borderColor="#d953ff");var i=this,a=this.opts.interval;this.intervalDone=!1,"success"!=s&&function(){var t=("fail"==s?i.opts.message.fail:i.opts.message.forbidden)+", "+a+"s 后重试";i.setFloatMessage(t);var e=setInterval(function(){a--;var t=("fail"==s?i.opts.message.fail:i.opts.message.forbidden)+", "+a+"s 后重试";i.setFloatMessage(t),a<=0&&(i.intervalDone=!0,i.requestDataDone&&i.setUserCanOperation(!0),i.resetTrack(),clearInterval(e))},1e3)}()},resetTrack:function(){this.captchaDOM.track.style.color="#000",this.captchaDOM.track.style.borderColor="#ddd",this.captchaDOM.result.className=this.captchaDOM.resultClass},setSlicePos:function(t){this.captchaDOM.slider.style.left=t-this.opts.dragWidth/2+"px",this.captchaDOM.clipblock.style.left=t-this.opts.cw/2+"px"},reset:function(){this.clearMouseTrack(),this.setSlicePos(this.opts.padding+this.opts.cw/2)},test:function(t){console.log(t);var e,s="force:"+(e=t.targetTouches[0]).force;s+="<br/>,radiusX:"+e.radiusX,s+="<br/>,radiusY:"+e.radiusY,s+="<br/>,rotationAngle:"+e.rotationAngle,s+="<br/>,force:"+(e=t.changedTouches[0]).force,s+="<br/>,radiusX:"+e.radiusX,s+="<br/>,radiusY:"+e.radiusY,s+="<br/>,rotationAngle:"+e.rotationAngle,s+="<br/>,force:"+(e=t.touches[0]).force,s+="<br/>,radiusX:"+e.radiusX,s+="<br/>,radiusY:"+e.radiusY,s+="<br/>,rotationAngle:"+e.rotationAngle,document.getElementById("ppp").innerHTML=s},moveStart:function(t){t=t||window.event;this.userIsCan&&(this.startTime=(new Date).getTime(),this.setMessage(""),this.opts.eventinfo.flag=!0,t.touches?this.opts.eventinfo.currentX=t.touches[0].clientX:this.opts.eventinfo.currentX=t.clientX),t.preventDefault?t.preventDefault():t.returnValue=!1},move:function(t){t=t||window.event;if(this.userIsCan){if(this.opts.eventinfo.flag){if(t.touches)var e=t.touches[0].clientX-this.opts.eventinfo.currentX;else e=t.clientX-this.opts.eventinfo.currentX;var s=this.opts.padding+this.opts.cw/2;return(e+=s)<s||e>this.opts.bgWidth-this.opts.padding-this.opts.cw/2||(this.setSlicePos(e),t.preventDefault?t.preventDefault():t.returnValue=!1),!1}}else t.preventDefault?t.preventDefault():t.returnValue=!1},getStyle:function(t,e){if(t.style[e])return t.style[e];if(t.currentStyle)return t.currentStyle[e];if(document.defaultView&&document.defaultView.getComputedStyle){var s=document.defaultView.getComputedStyle(t,"");return s&&s.getPropertyValue(e)}return null},setEleCannotselect:function(t){void 0!==t.onselectstart&&(t.onselectstart=new Function("return false"))},moveEnd:function(t){t=t||window.event;if(this.userIsCan&&this.opts.eventinfo.flag){this.opts.eventinfo.flag=!1;var e=parseFloat(this.getStyle(this.captchaDOM.clipblock,"left"));e+=this.opts.cw/2;var s={deviceInfo:this.opts.useDeviceInfo?this.getDeviceInfo():void 0,mouseInfo:this.getMouseTrack(),isMobile:this.isMobileDevice(),left:e,captchaType:"slice_check"};s=JSON.stringify(s),this.opts.useDES3&&(s=this.DES3encrypt(this.createKey(this.opts.clientID,this.keys),s));var i=(new Date).getTime()-this.startTime,a=Math.round(i/100)/10+"秒完成",o=this;this.setUserCanOperation(!1),this.setMessage(this.opts.message.checking);try{this.opts.sendData&&this.opts.sendData(s,function(t){var e={Data:"success"};e.Data="SUCCESS"==t?"success":"ERROR_1"==t?"fail":"forbid";try{var s=e.Data}catch(t){return console.error("解析服务器端返回的数据出错，错误信息如下："),void console.log(t)}o.setResultStatus(s,a),"success"!==s&&(o.errorNum=o.errorNum+1,setTimeout(function(){o.opts.needAgainNum<=o.errorNum?o.refreshMethod():(o.requestDataDone=!0,o.reset(),o.setMessage(o.opts.message.tip))},500));try{o.opts.checkResult(s)}catch(t){console.error("执行 checkResult() 函数时出错，错误信息如下："),console.log(t)}})}catch(t){console.error("执行 sendData() 函数时出错，错误信息如下："),console.log(t)}}}},"object"==typeof exports?module.exports=t:"function"==typeof define&&define.amd?define([],function(){return t}):window&&(window.SliceCaptcha=t,window._CaptchaObj=e)}();